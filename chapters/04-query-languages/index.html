
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="An interactive intelligent textbook covering an introduction to graph databases.  This textbook includes extensive MicroSims">
      
      
        <meta name="author" content="Dan McCreary">
      
      
        <link rel="canonical" href="https://dmccreary.github.io/intro-to-graph/chapters/04-query-languages/">
      
      
        <link rel="prev" href="../03-labeled-property-graph-model/quiz/">
      
      
        <link rel="next" href="quiz/">
      
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Content - Introduction to Graph Databases</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-TQMCGBJLX4"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-TQMCGBJLX4",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-TQMCGBJLX4",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Content - Introduction to Graph Databases" >
      
        <meta  property="og:description"  content="An interactive intelligent textbook covering an introduction to graph databases.  This textbook includes extensive MicroSims" >
      
        <meta  property="og:image"  content="https://dmccreary.github.io/intro-to-graph/assets/images/social/chapters/04-query-languages/index.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://dmccreary.github.io/intro-to-graph/chapters/04-query-languages/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Content - Introduction to Graph Databases" >
      
        <meta  name="twitter:description"  content="An interactive intelligent textbook covering an introduction to graph databases.  This textbook includes extensive MicroSims" >
      
        <meta  name="twitter:image"  content="https://dmccreary.github.io/intro-to-graph/assets/images/social/chapters/04-query-languages/index.png" >
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#query-languages-for-graph-databases" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Introduction to Graph Databases" class="md-header__button md-logo" aria-label="Introduction to Graph Databases" data-md-component="logo">
      
  <img src="../../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introduction to Graph Databases
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Content
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/dmccreary/intro-to-graph" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub Repo
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Introduction to Graph Databases" class="md-nav__button md-logo" aria-label="Introduction to Graph Databases" data-md-component="logo">
      
  <img src="../../img/logo.png" alt="logo">

    </a>
    Introduction to Graph Databases
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dmccreary/intro-to-graph" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub Repo
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course-description/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Course Description
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Chapters
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Chapters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../01-intro-graph-thinking-data-modeling/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 1 - Introduction to Graph Thinking
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../02-database-systems-nosql/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 2 - Database Systems and NoSQL
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../03-labeled-property-graph-model/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 3 - Labeled Property Graph Model
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="./" class="md-nav__link md-nav__link--active">
              
  
  
  <span class="md-ellipsis">
    Chapter 4 - Query Languages
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Chapter 4 - Query Languages
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quiz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quiz
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../05-performance-metrics-benchmarking/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 5 - Performance and Benchmarking
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../06-graph-algorithms/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 6 - Graph Algorithms
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../07-social-network-modeling/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 7 - Social Network Modeling
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../08-knowledge-representation-management/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 8 - Knowledge Representation
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../09-modeling-patterns-data-loading/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 9 - Modeling Patterns
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../10-commerce-supply-chain-it/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 10 - Commerce and Supply Chain
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../11-financial-healthcare-regulatory/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 11 - Financial and Healthcare
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../12-advanced-topics-distributed-systems/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 12 - Advanced Topics
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../sims/graph-viewer/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    MicroSims
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../learning-graph/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Learning Graph
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../stories/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Stories
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../prompts/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Prompts
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-we-built-this-site/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How We Built This Site
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../feedback/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feedback
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contact/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts-covered" class="md-nav__link">
    <span class="md-ellipsis">
      Concepts Covered
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-elephant-in-the-room-or-should-we-say-the-ai-in-the-cloud" class="md-nav__link">
    <span class="md-ellipsis">
      The Elephant in the Room (Or Should We Say, the AI in the Cloud?)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-languages-the-big-three-and-the-future" class="md-nav__link">
    <span class="md-ellipsis">
      Query Languages: The Big Three (and the Future)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Query Languages: The Big Three (and the Future)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#opencypher-the-peoples-champion" class="md-nav__link">
    <span class="md-ellipsis">
      OpenCypher: The People's Champion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gsql-the-distributed-powerhouse" class="md-nav__link">
    <span class="md-ellipsis">
      GSQL: The Distributed Powerhouse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gql-the-emerging-standard" class="md-nav__link">
    <span class="md-ellipsis">
      GQL: The Emerging Standard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#which-one-should-you-learn" class="md-nav__link">
    <span class="md-ellipsis">
      Which One Should You Learn?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cypher-syntax-the-ascii-art-of-graph-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Cypher Syntax: The ASCII Art of Graph Queries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cypher Syntax: The ASCII Art of Graph Queries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-core-philosophy-drawing-graphs-with-text" class="md-nav__link">
    <span class="md-ellipsis">
      The Core Philosophy: Drawing Graphs with Text
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodes-the-parentheses-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      Nodes: The Parentheses Pattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relationships-the-bracket-and-arrow-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      Relationships: The Bracket and Arrow Pattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-five-essential-clauses" class="md-nav__link">
    <span class="md-ellipsis">
      The Five Essential Clauses
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#match-clause-finding-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      MATCH Clause: Finding Patterns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-clause-filtering-results" class="md-nav__link">
    <span class="md-ellipsis">
      WHERE Clause: Filtering Results
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#return-clause-shaping-output" class="md-nav__link">
    <span class="md-ellipsis">
      RETURN Clause: Shaping Output
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-statement-adding-data" class="md-nav__link">
    <span class="md-ellipsis">
      CREATE Statement: Adding Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merge-statement-create-or-match" class="md-nav__link">
    <span class="md-ellipsis">
      MERGE Statement: Create or Match
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-clause-updating-properties" class="md-nav__link">
    <span class="md-ellipsis">
      SET Clause: Updating Properties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete-statement-removing-data" class="md-nav__link">
    <span class="md-ellipsis">
      DELETE Statement: Removing Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graph-patterns-the-power-of-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Graph Patterns: The Power of Structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variable-length-paths-following-the-rabbit-hole" class="md-nav__link">
    <span class="md-ellipsis">
      Variable-Length Paths: Following the Rabbit Hole
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shortest-path-finding-the-quickest-route" class="md-nav__link">
    <span class="md-ellipsis">
      Shortest Path: Finding the Quickest Route
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#all-paths-when-you-need-every-route" class="md-nav__link">
    <span class="md-ellipsis">
      All Paths: When You Need Every Route
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#declarative-vs-imperative-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Declarative vs. Imperative Queries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gsql-and-the-map-reduce-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      GSQL and the Map-Reduce Pattern
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GSQL and the Map-Reduce Pattern">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-gsql-exists" class="md-nav__link">
    <span class="md-ellipsis">
      Why GSQL Exists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accumulators-gsqls-secret-weapon" class="md-nav__link">
    <span class="md-ellipsis">
      Accumulators: GSQL's Secret Weapon
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-optimization-making-queries-fast" class="md-nav__link">
    <span class="md-ellipsis">
      Query Optimization: Making Queries Fast
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Query Optimization: Making Queries Fast">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-query-planners-work" class="md-nav__link">
    <span class="md-ellipsis">
      How Query Planners Work
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-optimizations" class="md-nav__link">
    <span class="md-ellipsis">
      Common Optimizations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-performance-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Query Performance Metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shortest-path-algorithms-under-the-hood" class="md-nav__link">
    <span class="md-ellipsis">
      Shortest Path Algorithms: Under the Hood
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Shortest Path Algorithms: Under the Hood">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#breadth-first-search-bfs" class="md-nav__link">
    <span class="md-ellipsis">
      Breadth-First Search (BFS)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dijkstras-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Dijkstra's Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      A* Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-you-care" class="md-nav__link">
    <span class="md-ellipsis">
      Why You Care
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-plans-reading-the-execution-blueprint" class="md-nav__link">
    <span class="md-ellipsis">
      Query Plans: Reading the Execution Blueprint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bringing-it-all-together-a-realistic-example" class="md-nav__link">
    <span class="md-ellipsis">
      Bringing It All Together: A Realistic Example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-bottom-line-why-learning-this-matters" class="md-nav__link">
    <span class="md-ellipsis">
      The Bottom Line: Why Learning This Matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/dmccreary/intro-to-graph/blob/master/docs/chapters/04-query-languages/index.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="query-languages-for-graph-databases">Query Languages for Graph Databases</h1>
<h2 id="summary">Summary</h2>
<p>This chapter provides comprehensive coverage of graph query languages including OpenCypher, GSQL, and the emerging GQL standard. You'll master Cypher syntax for pattern matching, learn how to construct complex graph queries with match, where, and return clauses, and explore GSQL's map-reduce pattern for distributed query processing. The chapter emphasizes both declarative and imperative query approaches, query optimization techniques, and performance considerations for production graph applications.</p>
<h2 id="concepts-covered">Concepts Covered</h2>
<p>This chapter covers the following 26 concepts from the learning graph:</p>
<ol>
<li>OpenCypher</li>
<li>GSQL</li>
<li>Statistical Query Tuning</li>
<li>GQL</li>
<li>Cypher Syntax</li>
<li>Match Clause</li>
<li>Where Clause</li>
<li>Return Clause</li>
<li>Create Statement</li>
<li>Merge Statement</li>
<li>Delete Statement</li>
<li>Set Clause</li>
<li>Graph Patterns</li>
<li>Variable Length Paths</li>
<li>Shortest Path</li>
<li>All Paths</li>
<li>Map-Reduce Pattern</li>
<li>Accumulators</li>
<li>Query Optimization</li>
<li>Query Performance</li>
<li>Query Latency</li>
<li>Query Throughput</li>
<li>Declarative Queries</li>
<li>Imperative Queries</li>
<li>Query Plans</li>
<li>Shortest Path Algorithms</li>
</ol>
<h2 id="prerequisites">Prerequisites</h2>
<p>This chapter builds on concepts from:</p>
<ul>
<li><a href="../03-labeled-property-graph-model/">Chapter 3: Labeled Property Graph Information Model</a></li>
</ul>
<hr />
<h2 id="the-elephant-in-the-room-or-should-we-say-the-ai-in-the-cloud">The Elephant in the Room (Or Should We Say, the AI in the Cloud?)</h2>
<p>Let's address something right up front: By the time you're reading this, AI capabilities are doubling roughly every seven months. There's a decent chance that by the time you're actually working with graph databases professionally, you'll just describe what you want in plain English, and an AI will write the query for you. "Hey AI, find all customers who bought products similar to Alice's purchases in the last month." Done.</p>
<p>So why are we about to spend an entire chapter learning Cypher syntax, GSQL patterns, and query optimization techniques?</p>
<p>Here's the thing (and we're giving you a knowing wink here): <strong>Understanding what the code does is valuable even if you never write it yourself.</strong> When the AI generates a query that returns 10 million nodes instead of the 10 you expected, you'll want to know why. When a query that should take milliseconds is taking minutes, you'll need to spot the problem. When you're reviewing what the AI suggested and something looks... off... you'll want the knowledge to catch it.</p>
<p>Think of it like learning to drive even though self-driving cars exist. Sure, the car might handle 99% of the driving, but you still want to know what's happening when you press the brake, right?</p>
<p>So yes, AI might write most of your graph queries in the future. But this chapter will teach you to read them, understand them, debug them, andâ€”when necessaryâ€”write them yourself. Consider it "AI literacy for graph databases."</p>
<p>Ready? Let's dive into graph query languages. And remember: every time you think "I'll never write this manually," imagine your future self saying "Thank goodness I learned this" when the AI suggests a query that would accidentally delete your entire production database. (We're joking. Mostly.)</p>
<h2 id="query-languages-the-big-three-and-the-future">Query Languages: The Big Three (and the Future)</h2>
<p>Before we dive into syntax, let's survey the landscape. There are three major query languages you should know about, plus a fourth that's emerging as a standard.</p>
<h3 id="opencypher-the-peoples-champion">OpenCypher: The People's Champion</h3>
<p><strong>OpenCypher</strong> is the most popular graph query language, originally developed by Neo4j and then open-sourced. It's declarative (you describe what you want, not how to get it), highly readable, and looks a bit like ASCII art of graphs.</p>
<p><strong>Why it's popular:</strong>
- <strong>Visual syntax:</strong> <code>(alice:Person)-[:FRIEND_OF]-&gt;(bob)</code> literally looks like a graph
- <strong>Declarative:</strong> Focus on the pattern you want, not the algorithm to find it
- <strong>Wide adoption:</strong> Neo4j, Amazon Neptune, Memgraph, RedisGraph, and many others
- <strong>Active community:</strong> Lots of resources, tutorials, and Stack Overflow answers</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">age</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p>Even if you've never seen Cypher before, you can probably guess what this does: Find Alice, find her friends, return their names and ages sorted by age.</p>
<h3 id="gsql-the-distributed-powerhouse">GSQL: The Distributed Powerhouse</h3>
<p><strong>GSQL</strong> (Graph SQL) is TigerGraph's query language, designed for massive-scale distributed graph processing. While Cypher is declarative, GSQL blends declarative and imperative styles, giving you fine-grained control over execution.</p>
<p><strong>Why it matters:</strong>
- <strong>Imperative control:</strong> You can specify exactly how to process the graph
- <strong>Map-reduce pattern:</strong> Built for distributed computation across clusters
- <strong>Accumulators:</strong> Powerful constructs for aggregating data during traversal
- <strong>Performance tuning:</strong> Fine-grained control for optimizing complex queries</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">QUERY</span><span class="w"> </span><span class="n">FindFriends</span><span class="o">(</span><span class="k">VERTEX</span><span class="p">&lt;</span><span class="n">Person</span><span class="p">&gt;</span><span class="w"> </span><span class="n">inputPerson</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">inputPerson</span><span class="p">}</span><span class="o">;</span>
<span class="w">  </span><span class="n">Friends</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">friend</span>
<span class="w">            </span><span class="k">FROM</span><span class="w"> </span><span class="n">Start</span><span class="o">:</span><span class="n">s</span><span class="w"> </span><span class="o">-(</span><span class="n">FRIEND_OF</span><span class="o">:</span><span class="n">e</span><span class="o">)-</span><span class="w"> </span><span class="n">Person</span><span class="o">:</span><span class="n">friend</span>
<span class="w">            </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="k">DESC</span><span class="o">;</span>
<span class="w">  </span><span class="k">PRINT</span><span class="w"> </span><span class="n">Friends</span><span class="o">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>GSQL looks more like traditional programmingâ€”you define variables, specify control flow, and manage execution explicitly.</p>
<h3 id="gql-the-emerging-standard">GQL: The Emerging Standard</h3>
<p><strong>GQL (Graph Query Language)</strong> is the ISO standard for graph queries, currently being developed by the same committee that created SQL. Think of it as "SQL for graphs."</p>
<p><strong>Why you should care (eventually):</strong>
- <strong>ISO standard:</strong> Official international standard, like SQL
- <strong>Industry consensus:</strong> Major vendors collaborating on unified syntax
- <strong>Future-proof:</strong> Learning GQL means learning the future lingua franca of graphs
- <strong>SQL familiarity:</strong> Designed to feel familiar to SQL developers</p>
<p><strong>Current status:</strong> Still emerging (as of 2025). Neo4j, Oracle, and other vendors are implementing support, but it's not yet as mature as Cypher or GSQL.</p>
<p><strong>What it looks like:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>MATCH (alice:Person WHERE alice.name = &#39;Alice&#39;)-[:FRIEND_OF]-&gt;(friend:Person)
RETURN friend.name, friend.age
ORDER BY friend.age DESC
</code></pre></div></td></tr></table></div></p>
<p>Familiar, right? It's intentionally similar to Cypher but with SQL-like syntax elements.</p>
<h3 id="which-one-should-you-learn">Which One Should You Learn?</h3>
<p><strong>Short answer:</strong> Start with Cypher. It's the most widely used, has the best tutorials, and concepts transfer easily to other languages.</p>
<p><strong>Long answer:</strong> Cypher will teach you graph thinking. GSQL will teach you performance optimization. GQL will prepare you for the future. Ideally, know enough Cypher to read and write basic queries, understand GSQL concepts for distributed systems, and keep an eye on GQL for standardization.</p>
<p>And remember: The AI will probably write queries in whatever language your database supports. Your job is to understand what it wrote. ðŸ˜‰</p>
<h2 id="cypher-syntax-the-ascii-art-of-graph-queries">Cypher Syntax: The ASCII Art of Graph Queries</h2>
<p>Let's dive deep into Cypher, the most popular graph query language. We'll cover enough that when an AI (or a colleague, or your future self) writes a Cypher query, you'll know exactly what's happening.</p>
<h3 id="the-core-philosophy-drawing-graphs-with-text">The Core Philosophy: Drawing Graphs with Text</h3>
<p>Cypher's genius is visual syntax. Compare these:</p>
<p><strong>What you're thinking:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>Alice --[FRIEND_OF]--&gt; Bob
</code></pre></div></td></tr></table></div></p>
<p><strong>What you write:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<p>See the similarity? Nodes in parentheses <code>()</code>, relationships in brackets <code>[]</code>, arrows showing direction <code>-&gt;</code>. It's ASCII art that happens to be executable code.</p>
<h3 id="nodes-the-parentheses-pattern">Nodes: The Parentheses Pattern</h3>
<p>Nodes are always wrapped in parentheses:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">()</span><span class="w">                           </span><span class="c1">// Anonymous node (any node)</span>
<span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w">                          </span><span class="c1">// Node bound to variable &#39;n&#39;</span>
<span class="p">(:</span><span class="n">Person</span><span class="p">)</span><span class="w">                    </span><span class="c1">// Node with label &#39;Person&#39;</span>
<span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="w">                   </span><span class="c1">// Person node bound to variable &#39;p&#39;</span>
<span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="w">  </span><span class="c1">// Person named Alice</span>
<span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">:</span><span class="n">Employee</span><span class="p">)</span><span class="w">          </span><span class="c1">// Node with multiple labels</span>
</code></pre></div></td></tr></table></div>
<p><strong>Breaking down the anatomy:</strong>
- <code>(variable:Label {property: value})</code>
- <strong>Variable</strong> (optional): Lets you refer to the node later in the query
- <strong>Label</strong> (optional): The type/category of node
- <strong>Properties</strong> (optional): Key-value pairs to match or filter</p>
<h3 id="relationships-the-bracket-and-arrow-pattern">Relationships: The Bracket and Arrow Pattern</h3>
<p>Relationships use brackets and arrows:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="w">              </span><span class="c1">// Directed relationship, specific type</span>
<span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-</span><span class="w">               </span><span class="c1">// Undirected (matches either direction)</span>
<span class="o">&lt;-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-</span><span class="w">              </span><span class="c1">// Relationship pointing left</span>
<span class="o">-[</span><span class="n">r</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="w">             </span><span class="c1">// Relationship bound to variable &#39;r&#39;</span>
<span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="w"> </span><span class="p">{</span><span class="n">since</span><span class="p">:</span><span class="w"> </span><span class="m">2020</span><span class="p">}</span><span class="o">]-&gt;</span><span class="w">  </span><span class="c1">// Relationship with properties</span>
<span class="o">-[</span><span class="p">*</span><span class="m">1</span><span class="p">..</span><span class="m">3</span><span class="o">]-&gt;</span><span class="w">                   </span><span class="c1">// Variable-length path (1 to 3 hops)</span>
<span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="p">|</span><span class="n">COLLEAGUE</span><span class="o">]-&gt;</span><span class="w">    </span><span class="c1">// Multiple relationship types (OR)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Direction matters (usually):</strong>
- <code>(alice)-[:PURCHASED]-&gt;(product)</code> - Alice purchased product âœ…
- <code>(product)-[:PURCHASED]-&gt;(alice)</code> - Product purchased Alice? âŒ (semantically weird)</p>
<p>But you can traverse backwards:
- <code>(alice)&lt;-[:PURCHASED]-(product)</code> - Products purchased by Alice (same data, viewed backwards)</p>
<h3 id="the-five-essential-clauses">The Five Essential Clauses</h3>
<p>Cypher queries are built from clauses, like SQL. Here are the five you'll use constantly:</p>
<ol>
<li><strong>MATCH</strong> - Find patterns in the graph</li>
<li><strong>WHERE</strong> - Filter results</li>
<li><strong>RETURN</strong> - Specify what to output</li>
<li><strong>CREATE</strong> - Add new data</li>
<li><strong>DELETE</strong> - Remove data</li>
</ol>
<p>Let's explore each in detail.</p>
<h2 id="match-clause-finding-patterns">MATCH Clause: Finding Patterns</h2>
<p>The <strong>MATCH clause</strong> is the heart of Cypher queries. It describes a pattern you want to find in the graph.</p>
<p><strong>Simple matching:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find all Person nodes</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>

<span class="c1">// Find all friendships</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>

<span class="c1">// Find Alice specifically</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Multi-hop matching:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find friends of friends (2 hops)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">()</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">fof</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">fof</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>

<span class="c1">// Find who Alice&#39;s friends follow (mixing relationship types)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FOLLOWS</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">celebrity</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">celebrity</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Multiple patterns:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find people who are both friends AND work at the same company</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">WORKS_AT</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">company</span><span class="p">)</span><span class="o">&lt;-[</span><span class="p">:</span><span class="n">WORKS_AT</span><span class="o">]-</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">company</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Optional patterns:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find Alice&#39;s friends, and their companies if they have them</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">OPTIONAL</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">friend</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">WORKS_AT</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">company</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">company</span><span class="p">.</span><span class="n">name</span><span class="p">;</span><span class="w">  </span><span class="c1">// company.name might be null</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>The abstract concept:</strong> MATCH is declarative pattern matching. You describe the shape you want, and the query engine finds all instances of that shape in your graph.</p>
<p><strong>The practical reality:</strong> When you tell an AI "find Alice's friends," it writes a MATCH clause. When the query takes too long, you'll look at the MATCH clause to see if it's searching too broadly.</p>
<h2 id="where-clause-filtering-results">WHERE Clause: Filtering Results</h2>
<p>The <strong>WHERE clause</strong> filters matches based on conditions, just like SQL.</p>
<p><strong>Property filtering:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Friends over 30</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">30</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>

<span class="c1">// Multiple conditions</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Seattle&quot;</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>

<span class="c1">// Pattern matching in strings</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">email</span><span class="w"> </span><span class="k">ENDS</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="s">&quot;@example.com&quot;</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Relationship filtering:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Friendships formed after 2020</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="o">-[</span><span class="n">r</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">since</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="n">date</span><span class="p">(</span><span class="s">&quot;2020-01-01&quot;</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">since</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Null checking:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// People who have an email address</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">email</span><span class="w"> </span><span class="n">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>List operations:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// People in specific cities</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="o">[</span><span class="s">&quot;Seattle&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Portland&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;San Francisco&quot;</span><span class="o">]</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Pattern-based filtering:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find people who have friends but don&#39;t work anywhere</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">()</span>
<span class="k">WHERE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">WORKS_AT</span><span class="o">]-&gt;</span><span class="p">()</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Pro tip:</strong> You can often put properties directly in MATCH <code>(p:Person {age: 30})</code> instead of using WHERE <code>WHERE p.age = 30</code>. They're equivalent, but WHERE is more flexible for complex conditions.</p>
<h2 id="return-clause-shaping-output">RETURN Clause: Shaping Output</h2>
<p>The <strong>RETURN clause</strong> specifies what data you want back from the query.</p>
<p><strong>Basic returns:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Return nodes</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>

<span class="c1">// Return specific properties</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span><span class="p">;</span>

<span class="c1">// Return with aliases</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">person_name</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">person_age</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Returning relationships:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Return the whole pattern</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="o">-[</span><span class="n">r</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>

<span class="c1">// Return relationship properties</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="o">-[</span><span class="n">r</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">since</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Computed values:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Calculate on the fly</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="m">2025</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">birth_year</span><span class="p">;</span>

<span class="c1">// String concatenation</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="s">&quot; (&quot;</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">person_description</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Aggregations:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Count friends</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">friend</span><span class="p">);</span>

<span class="c1">// Average age of friends</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">avg</span><span class="p">(</span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="p">),</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="p">),</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="p">);</span>

<span class="c1">// Group and count</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">population</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">population</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Sorting and limiting:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Sort by age</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>

<span class="c1">// Top 10 oldest people</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="k">DESC</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="m">10</span><span class="p">;</span>

<span class="c1">// Skip and limit (pagination)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span>
<span class="k">SKIP</span><span class="w"> </span><span class="m">20</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="m">10</span><span class="p">;</span><span class="w">  </span><span class="c1">// Results 21-30</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>DISTINCT results:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Unique cities</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="p">;</span>

<span class="c1">// Count unique cities</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">city</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<h2 id="create-statement-adding-data">CREATE Statement: Adding Data</h2>
<p>The <strong>CREATE statement</strong> adds new nodes and relationships to the graph.</p>
<p><strong>Creating nodes:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Create a single node</span>
<span class="k">CREATE</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="m">28</span><span class="p">,</span><span class="w"> </span><span class="n">city</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Seattle&quot;</span><span class="p">});</span>

<span class="c1">// Create multiple nodes at once</span>
<span class="k">CREATE</span>
<span class="w">  </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="m">28</span><span class="p">}),</span>
<span class="w">  </span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="m">35</span><span class="p">}),</span>
<span class="w">  </span><span class="p">(</span><span class="n">techcorp</span><span class="p">:</span><span class="n">Company</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TechCorp&quot;</span><span class="p">});</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Creating relationships:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Create nodes and relationship in one statement</span>
<span class="k">CREATE</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="w"> </span><span class="p">{</span><span class="n">since</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2020-05-12&quot;</span><span class="p">}</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">});</span>

<span class="c1">// Add relationship between existing nodes</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">})</span>
<span class="k">CREATE</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="w"> </span><span class="p">{</span><span class="n">since</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2020-05-12&quot;</span><span class="p">}</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">bob</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Creating patterns:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Create a whole social network structure</span>
<span class="k">CREATE</span>
<span class="w">  </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">}),</span>
<span class="w">  </span><span class="p">(</span><span class="n">bob</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">charlie</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Charlie&quot;</span><span class="p">}),</span>
<span class="w">  </span><span class="p">(</span><span class="n">charlie</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">alice</span><span class="p">),</span>
<span class="w">  </span><span class="p">(</span><span class="n">alice</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">WORKS_AT</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">techcorp</span><span class="p">:</span><span class="n">Company</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TechCorp&quot;</span><span class="p">}),</span>
<span class="w">  </span><span class="p">(</span><span class="n">bob</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">WORKS_AT</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">techcorp</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Returning created data:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">:</span><span class="w"> </span><span class="m">28</span><span class="p">})</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Important warning:</strong> CREATE always creates new nodes/relationships, even if they already exist. If you run the same CREATE statement twice, you'll get duplicates. That's where MERGE comes in...</p>
<h2 id="merge-statement-create-or-match">MERGE Statement: Create or Match</h2>
<p>The <strong>MERGE statement</strong> is like "create if it doesn't exist, otherwise match." It's idempotentâ€”running it multiple times has the same effect as running it once.</p>
<p><strong>Basic MERGE:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Create Alice if she doesn&#39;t exist</span>
<span class="k">MERGE</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span>

<span class="c1">// Run this 10 times - still only one Alice node</span>
<span class="k">MERGE</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>MERGE with ON CREATE:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Set properties only when creating new node</span>
<span class="k">MERGE</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">ON</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">created</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">timestamp</span><span class="p">(),</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="m">28</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>MERGE with ON MATCH:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Update last_seen every time we match Alice</span>
<span class="k">MERGE</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">ON</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">last_seen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">timestamp</span><span class="p">()</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>MERGE with both:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">MERGE</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">ON</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">created</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">timestamp</span><span class="p">(),</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="m">28</span>
<span class="k">ON</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">last_seen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">timestamp</span><span class="p">()</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>MERGE relationships:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Ensure friendship exists (create if missing)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">})</span>
<span class="k">MERGE</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">)</span><span class="o">-[</span><span class="n">r</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">bob</span><span class="p">)</span>
<span class="k">ON</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">since</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">date</span><span class="p">()</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Why MERGE matters:</strong> When loading data from external sources, you often don't know if nodes already exist. MERGE handles this gracefullyâ€”no duplicates, no errors.</p>
<p><strong>When the AI uses MERGE:</strong> If you ask an AI to "make sure Alice is friends with Bob," it should use MERGE, not CREATE. If it uses CREATE, you might end up with 50 duplicate FRIEND_OF relationships. Now you know to spot that!</p>
<h2 id="set-clause-updating-properties">SET Clause: Updating Properties</h2>
<p>The <strong>SET clause</strong> modifies properties on existing nodes and relationships.</p>
<p><strong>Setting properties:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Update a single property</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">SET</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="m">29</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span>

<span class="c1">// Update multiple properties</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">SET</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="m">29</span><span class="p">,</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Portland&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">updated</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">timestamp</span><span class="p">()</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Adding labels:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Add a label to a node</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">SET</span><span class="w"> </span><span class="n">alice</span><span class="p">:</span><span class="n">Employee</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span><span class="w">  </span><span class="c1">// Now alice has labels Person AND Employee</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Copying properties:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Copy all properties from one node to another</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">template</span><span class="p">:</span><span class="n">PersonTemplate</span><span class="p">)</span>
<span class="k">SET</span><span class="w"> </span><span class="n">alice</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">template</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Conditional updates:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Update age only if current age is less than 30</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="m">30</span>
<span class="k">SET</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="m">1</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">age</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Updating relationship properties:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="o">-[</span><span class="n">r</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span>
<span class="k">SET</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">closeness</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="m">0</span><span class="p">.</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">last_contact</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">date</span><span class="p">()</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<h2 id="delete-statement-removing-data">DELETE Statement: Removing Data</h2>
<p>The <strong>DELETE statement</strong> removes nodes and relationships from the graph.</p>
<p><strong>Deleting relationships:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Delete a specific friendship</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="n">r</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">})</span>
<span class="k">DELETE</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>

<span class="c1">// Delete all FRIEND_OF relationships</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">()</span><span class="o">-[</span><span class="n">r</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">()</span>
<span class="k">DELETE</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Deleting nodes:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Delete a node (must delete its relationships first!)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">DELETE</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span><span class="w">  </span><span class="c1">// ERROR if Alice has any relationships</span>

<span class="c1">// Delete node and all its relationships</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="n">DETACH</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span><span class="w">  </span><span class="c1">// Deletes Alice and all connected relationships</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Conditional deletion:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Delete inactive users</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">last_seen</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="n">date</span><span class="p">()</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="n">duration</span><span class="p">({</span><span class="n">months</span><span class="p">:</span><span class="w"> </span><span class="m">6</span><span class="p">})</span>
<span class="n">DETACH</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Deleting all data (use with extreme caution!):</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Delete everything in the database</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">DETACH</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w">  </span><span class="c1">// âš ï¸ This removes EVERYTHING</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Why DETACH DELETE exists:</strong> In graph databases, you can't have relationships pointing to non-existent nodes. If you try to DELETE a node that has relationships, the database will throw an error. DETACH DELETE removes the relationships first, then the node.</p>
<p><strong>When the AI might get this wrong:</strong> If the AI tries to DELETE a node without DETACH, the query will fail. Now you'll know to add DETACH. (See? Understanding syntax helps even when AI writes code!)</p>
<h2 id="graph-patterns-the-power-of-structure">Graph Patterns: The Power of Structure</h2>
<p><strong>Graph patterns</strong> are the core of Cypher queriesâ€”they describe shapes you want to find in your graph.</p>
<p><strong>Basic patterns:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Simple 1-hop pattern</span>
<span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">KNOWS</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<span class="c1">// 2-hop pattern</span>
<span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">KNOWS</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">KNOWS</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="c1">// Triangle pattern</span>
<span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">KNOWS</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">KNOWS</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">KNOWS</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="c1">// Star pattern (central node with multiple connections)</span>
<span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">CONNECTED_TO</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">n1</span><span class="p">),</span>
<span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">CONNECTED_TO</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">n2</span><span class="p">),</span>
<span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">CONNECTED_TO</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Pattern with multiple relationship types:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Alice&#39;s friends who work at companies Alice follows</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="w">      </span><span class="o">-[</span><span class="p">:</span><span class="n">WORKS_AT</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">company</span><span class="p">)</span><span class="o">&lt;-[</span><span class="p">:</span><span class="n">FOLLOWS</span><span class="o">]-</span><span class="p">(</span><span class="n">alice</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">company</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Patterns with constraints:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find fraud rings: groups where everyone knows everyone (cliques)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">TRANSFERRED_MONEY</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="w">     </span><span class="o">-[</span><span class="p">:</span><span class="n">TRANSFERRED_MONEY</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">TRANSFERRED_MONEY</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">&lt;&gt;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">&lt;&gt;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">&lt;&gt;</span><span class="w"> </span><span class="n">a</span><span class="w">  </span><span class="c1">// Ensure they&#39;re distinct</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Anti-patterns (patterns that should NOT exist):</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find people who have friends but no job</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">()</span>
<span class="k">WHERE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">WORKS_AT</span><span class="o">]-&gt;</span><span class="p">()</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Why patterns matter:</strong> Patterns let you express complex graph queries concisely. Finding triangles (3-way relationships) in SQL would require multiple self-joins. In Cypher, it's one visual pattern.</p>
<h2 id="variable-length-paths-following-the-rabbit-hole">Variable-Length Paths: Following the Rabbit Hole</h2>
<p><strong>Variable-length paths</strong> let you traverse relationships without knowing how many hops you need.</p>
<p><strong>Basic syntax:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">-[</span><span class="p">*</span><span class="o">]-&gt;</span><span class="w">           </span><span class="c1">// Any number of hops (use carefullyâ€”can be slow!)</span>
<span class="o">-[</span><span class="p">*</span><span class="m">1</span><span class="p">..</span><span class="m">3</span><span class="o">]-&gt;</span><span class="w">       </span><span class="c1">// 1 to 3 hops</span>
<span class="o">-[</span><span class="p">*..</span><span class="m">5</span><span class="o">]-&gt;</span><span class="w">        </span><span class="c1">// Up to 5 hops</span>
<span class="o">-[</span><span class="p">*</span><span class="m">2</span><span class="p">..</span><span class="o">]-&gt;</span><span class="w">        </span><span class="c1">// At least 2 hops</span>
<span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="p">*</span><span class="m">1</span><span class="p">..</span><span class="m">3</span><span class="o">]-&gt;</span><span class="w">  </span><span class="c1">// 1-3 hops of FRIEND_OF relationships</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Real examples:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find everyone within 3 degrees of Alice</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="p">*</span><span class="m">1</span><span class="p">..</span><span class="m">3</span><span class="o">]-</span><span class="p">(</span><span class="n">connected</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">connected</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>

<span class="c1">// Find influence chains: who can reach CEO through management?</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">employee</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">REPORTS_TO</span><span class="p">*</span><span class="m">1</span><span class="p">..</span><span class="m">10</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">ceo</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CEO&quot;</span><span class="p">})</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">employee</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">distance</span><span class="p">;</span>

<span class="c1">// Find product recommendations: friends of friends who bought similar products</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="p">*</span><span class="m">2</span><span class="o">]-</span><span class="p">(</span><span class="n">fof</span><span class="p">)</span>
<span class="w">     </span><span class="o">-[</span><span class="p">:</span><span class="n">PURCHASED</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">PURCHASED</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">product</span><span class="p">)</span><span class="w">  </span><span class="c1">// Alice hasn&#39;t bought it yet</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">fof</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">friend_count</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">friend_count</span><span class="w"> </span><span class="k">DESC</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="m">10</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Why variable-length paths are powerful:</strong> They let you explore network effects, influence propagation, recommendation chains, and supply chain dependencies without knowing the exact number of hops beforehand.</p>
<p><strong>Performance warning:</strong> Variable-length paths can be expensive. <code>[:FRIEND_OF*]</code> with no upper limit might traverse millions of relationships. Always set an upper bound (<code>*1..5</code>) unless you have a very good reason not to.</p>
<p><strong>When the AI might mess this up:</strong> If the AI writes <code>[:FRIEND_OF*]</code> without a limit on a large graph, the query might run forever. Understanding this helps you spot the issue.</p>
<h2 id="shortest-path-finding-the-quickest-route">Shortest Path: Finding the Quickest Route</h2>
<p><strong>Shortest path</strong> finds the minimal-hop route between two nodes.</p>
<p><strong>Basic shortest path:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find shortest friendship chain between Alice and Bob</span>
<span class="k">MATCH</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">shortestPath</span><span class="p">((</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="w">                         </span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="p">*</span><span class="o">]-</span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">}))</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>All shortest paths:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find all shortest paths (there might be multiple routes with same length)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">allShortestPaths</span><span class="p">((</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="w">                              </span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="p">*</span><span class="o">]-</span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">}))</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">paths</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">paths</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Shortest path with relationship type filter:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Shortest professional connection (via WORKS_AT and PARTNER_WITH)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">shortestPath</span><span class="p">((</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="w">                         </span><span class="o">-[</span><span class="p">:</span><span class="n">WORKS_AT</span><span class="p">|</span><span class="n">PARTNER_WITH</span><span class="p">*</span><span class="o">]-</span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">}))</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">path</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Shortest path with max length:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find shortest path within 5 hops (return null if no path exists)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">shortestPath</span><span class="p">((</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="w">                         </span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="p">*..</span><span class="m">5</span><span class="o">]-</span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">}))</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">path</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Real-world use cases:</strong>
- <strong>Social networks:</strong> Six degrees of separation, connection suggestions
- <strong>Supply chains:</strong> Find fastest route from manufacturer to customer
- <strong>Network routing:</strong> Shortest path between network nodes
- <strong>Knowledge graphs:</strong> How are two concepts related?</p>
<p><strong>The abstract concept:</strong> Shortest path algorithms (Dijkstra's, BFS) find minimal-cost routes through graphs. Cypher abstracts this complexity into simple syntax.</p>
<h2 id="all-paths-when-you-need-every-route">All Paths: When You Need Every Route</h2>
<p><strong>All paths</strong> returns every possible route between two nodes (use carefullyâ€”can be huge!).</p>
<p><strong>Basic syntax:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find all paths between Alice and Bob (up to 4 hops)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="w">             </span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="p">*..</span><span class="m">4</span><span class="o">]-</span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">})</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">paths</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Filtered paths:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Find all collaboration paths through projects</span>
<span class="k">MATCH</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="w">             </span><span class="o">-[</span><span class="p">:</span><span class="n">WORKED_ON</span><span class="o">]-&gt;</span><span class="p">(:</span><span class="n">Project</span><span class="p">)</span><span class="o">&lt;-[</span><span class="p">:</span><span class="n">WORKED_ON</span><span class="p">*..</span><span class="m">3</span><span class="o">]-</span><span class="p">(</span><span class="n">bob</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">})</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">1</span><span class="w">  </span><span class="c1">// At least 2 hops</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">paths</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="m">100</span><span class="p">;</span><span class="w">  </span><span class="c1">// Prevent returning millions of paths</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Why you'd want all paths:</strong>
- <strong>Redundancy analysis:</strong> How many ways can information flow?
- <strong>Risk assessment:</strong> If one connection fails, what are the alternatives?
- <strong>Network analysis:</strong> Understanding structural properties of graphs</p>
<p><strong>Why all paths is dangerous:</strong> On a densely connected graph, the number of paths can grow exponentially. ALWAYS use LIMIT and max-length constraints.</p>
<p><strong>When the AI might overuse this:</strong> If you ask "how is Alice related to Bob," a naive AI might use all paths, returning millions of results. Shortest path is usually better.</p>
<h2 id="declarative-vs-imperative-queries">Declarative vs. Imperative Queries</h2>
<p>One of the key concepts in query languages is the difference between <strong>declarative</strong> and <strong>imperative</strong> approaches.</p>
<p><strong>Declarative queries</strong> (Cypher's style):
- You describe <strong>what</strong> you want, not <strong>how</strong> to find it
- The database figures out the optimal execution plan
- Easier to write, harder to optimize manually</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Declarative: &quot;Find Alice&#39;s friends over 30&quot;</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">30</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p>You didn't specify:
- Which index to use
- Which node to start from
- What traversal algorithm to use
- How to filter results</p>
<p>The query planner handles all that.</p>
<p><strong>Imperative queries</strong> (GSQL's style):
- You specify <strong>how</strong> to execute the query step-by-step
- More control over execution, more code complexity
- Useful for optimizing complex queries on massive graphs</p>
<p><strong>Example (GSQL):</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">QUERY</span><span class="w"> </span><span class="n">FindOlderFriends</span><span class="o">(</span><span class="k">VERTEX</span><span class="p">&lt;</span><span class="n">Person</span><span class="p">&gt;</span><span class="w"> </span><span class="n">alice</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nb">SumAccum</span><span class="p">&lt;</span><span class="k">INT</span><span class="p">&gt;</span><span class="w"> </span><span class="nv">@@count</span><span class="o">;</span>

<span class="w">  </span><span class="n">Start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">alice</span><span class="p">}</span><span class="o">;</span>

<span class="w">  </span><span class="n">Friends</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">friend</span>
<span class="w">            </span><span class="k">FROM</span><span class="w"> </span><span class="n">Start</span><span class="o">:</span><span class="n">s</span><span class="w"> </span><span class="o">-(</span><span class="n">FRIEND_OF</span><span class="o">:</span><span class="n">e</span><span class="o">)-</span><span class="p">&gt;</span><span class="w"> </span><span class="n">Person</span><span class="o">:</span><span class="n">friend</span>
<span class="w">            </span><span class="k">WHERE</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">30</span>
<span class="w">            </span><span class="k">ACCUM</span><span class="w"> </span><span class="nv">@@count</span><span class="w"> </span><span class="o">+= </span><span class="m">1</span><span class="o">;</span>

<span class="w">  </span><span class="k">PRINT</span><span class="w"> </span><span class="n">Friends</span><span class="o">,</span><span class="w"> </span><span class="nv">@@count</span><span class="o">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>Here you explicitly:
- Define accumulators (<code>@@count</code>)
- Specify traversal start (<code>Start = {alice}</code>)
- Control execution flow</p>
<p><strong>Which is better?</strong> Neitherâ€”they're different tools for different jobs:
- <strong>Declarative</strong> for most queries, rapid development, standard use cases
- <strong>Imperative</strong> for performance-critical queries, complex aggregations, distributed processing</p>
<p><strong>AI implication:</strong> Most AI systems will generate declarative queries (Cypher) because they're simpler and more portable. If you need imperative control (GSQL), you might need to guide the AI more specifically.</p>
<h2 id="gsql-and-the-map-reduce-pattern">GSQL and the Map-Reduce Pattern</h2>
<p>Let's talk about <strong>GSQL</strong> and why TigerGraph designed a different approach.</p>
<h3 id="why-gsql-exists">Why GSQL Exists</h3>
<p>Cypher is great for small-to-medium graphs (millions of nodes). But when you hit billions of nodes and trillions of relationships across distributed clusters, declarative queries can struggle with optimization. GSQL was designed for this scale.</p>
<p><strong>GSQL's map-reduce pattern</strong> processes graphs in stages:</p>
<ol>
<li><strong>Map:</strong> Transform each vertex/edge</li>
<li><strong>Reduce:</strong> Aggregate results</li>
<li><strong>Repeat:</strong> Iterate until convergence</li>
</ol>
<p>This mirrors big data processing frameworks (Hadoop MapReduce, Spark), but optimized for graphs.</p>
<h3 id="accumulators-gsqls-secret-weapon">Accumulators: GSQL's Secret Weapon</h3>
<p><strong>Accumulators</strong> are variables that collect data during graph traversal.</p>
<p><strong>Types of accumulators:</strong>
- <code>SumAccum&lt;INT&gt;</code> - Sum integers
- <code>AvgAccum</code> - Calculate averages
- <code>MaxAccum</code> / <code>MinAccum</code> - Track max/min values
- <code>ListAccum&lt;STRING&gt;</code> - Collect lists
- <code>SetAccum&lt;VERTEX&gt;</code> - Collect unique vertices</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">QUERY</span><span class="w"> </span><span class="n">CountFriendsByCity</span><span class="o">(</span><span class="k">VERTEX</span><span class="p">&lt;</span><span class="n">Person</span><span class="p">&gt;</span><span class="w"> </span><span class="n">alice</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nb">MapAccum</span><span class="p">&lt;</span><span class="k">STRING</span><span class="o">,</span><span class="w"> </span><span class="k">INT</span><span class="p">&gt;</span><span class="w"> </span><span class="nv">@@cityCount</span><span class="o">;</span>

<span class="w">  </span><span class="n">Start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">alice</span><span class="p">}</span><span class="o">;</span>

<span class="w">  </span><span class="n">Friends</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">friend</span>
<span class="w">            </span><span class="k">FROM</span><span class="w"> </span><span class="n">Start</span><span class="w"> </span><span class="o">-(:</span><span class="n">FRIEND_OF</span><span class="o">)-&gt;</span><span class="w"> </span><span class="n">Person</span><span class="o">:</span><span class="n">friend</span>
<span class="w">            </span><span class="k">ACCUM</span><span class="w"> </span><span class="nv">@@cityCount</span><span class="w"> </span><span class="o">+= (</span><span class="n">friend</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="m">1</span><span class="o">);</span>

<span class="w">  </span><span class="k">PRINT</span><span class="w"> </span><span class="nv">@@cityCount</span><span class="o">;</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">Might</span><span class="w"> </span><span class="k">return</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;Seattle&quot;</span><span class="o">:</span><span class="w"> </span><span class="m">5</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;Portland&quot;</span><span class="o">:</span><span class="w"> </span><span class="m">3</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;SF&quot;</span><span class="o">:</span><span class="w"> </span><span class="m">2</span><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Why accumulators matter:</strong> They let you aggregate data during traversal, not after. This is much faster on distributed systems because you're not shuffling data across network.</p>
<p><strong>Cypher equivalent (less efficient at scale):</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="n">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">city</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p>Both produce the same result, but on a 10-billion-edge graph, GSQL's accumulator approach can be orders of magnitude faster.</p>
<p><strong>When you'd use GSQL:</strong>
- Billion+ node graphs
- Distributed processing across clusters
- Complex multi-hop aggregations
- Graph algorithms (PageRank, community detection, centrality)
- Real-time fraud detection at scale</p>
<p><strong>When you'd stick with Cypher:</strong>
- Graphs under 100 million nodes
- Standard CRUD operations
- Rapid development
- Team familiarity with declarative SQL-like syntax</p>
<h2 id="query-optimization-making-queries-fast">Query Optimization: Making Queries Fast</h2>
<p>Understanding <strong>query optimization</strong> helps you read query plans and spot performance issues.</p>
<h3 id="how-query-planners-work">How Query Planners Work</h3>
<p>When you write a Cypher query, the database doesn't execute it literally. It:</p>
<ol>
<li><strong>Parses</strong> the query into an abstract syntax tree</li>
<li><strong>Optimizes</strong> by rewriting into equivalent but faster forms</li>
<li><strong>Generates a query plan</strong> specifying execution order</li>
<li><strong>Executes</strong> the plan</li>
</ol>
<p><strong>View the query plan:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">EXPLAIN</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">30</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p>This shows you what the database will do without actually running the query.</p>
<p><strong>Analyze actual execution:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">PROFILE</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">30</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p>PROFILE runs the query and shows actual row counts, execution time per step.</p>
<h3 id="common-optimizations">Common Optimizations</h3>
<p><strong>1. Index usage:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Slow (table scan)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>

<span class="c1">// Fast (index seek) if you&#39;ve created an index</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">person_name</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="w"> </span><span class="n">ON</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>2. Filter early:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Slower: match everything, then filter</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">30</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">friend</span><span class="p">;</span>

<span class="c1">// Faster: filter Alice first, then traverse</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">30</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">friend</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>3. Avoid Cartesian products:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Slow (Cartesian product: all people Ã— all companies)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">Company</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;TechCorp&quot;</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>

<span class="c1">// Fast (connected pattern)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">WORKS_AT</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">Company</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TechCorp&quot;</span><span class="p">})</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>4. Use LIMIT when exploring:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Risky (might return millions)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>

<span class="c1">// Safe (stops after 100)</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">p</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="m">100</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="query-performance-metrics">Query Performance Metrics</h3>
<p><strong>Query latency:</strong> How long does one query take?
- Good: &lt; 100ms
- Acceptable: 100ms - 1s
- Slow: &gt; 1s
- Fix it: &gt; 10s</p>
<p><strong>Query throughput:</strong> How many queries per second can the system handle?
- Measure with: Queries per second (QPS)
- Affected by: Concurrency, caching, index quality, hardware</p>
<p><strong>Statistical Query Tuning:</strong> Use PROFILE to identify bottlenecks:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">PROFILE</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="p">*</span><span class="m">1</span><span class="p">..</span><span class="m">3</span><span class="o">]-</span><span class="p">(</span><span class="n">connected</span><span class="p">)</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">connected</span><span class="p">);</span>
</code></pre></div></td></tr></table></div></p>
<p>Look for:
- <strong>High db hits:</strong> Operations scanning too many nodes/relationships
- <strong>Large row counts:</strong> Intermediate results that should be filtered earlier
- <strong>Missing index usage:</strong> Scans instead of index seeks</p>
<h2 id="shortest-path-algorithms-under-the-hood">Shortest Path Algorithms: Under the Hood</h2>
<p>You've used <code>shortestPath()</code> in Cypher, but what's actually happening?</p>
<h3 id="breadth-first-search-bfs">Breadth-First Search (BFS)</h3>
<p><strong>How it works:</strong>
1. Start at source node
2. Explore all neighbors (1-hop away)
3. Explore all neighbors' neighbors (2-hops away)
4. Continue until target found</p>
<p><strong>Why it finds shortest paths:</strong> BFS explores layer by layer, so first time it reaches the target is guaranteed to be the shortest path (for unweighted graphs).</p>
<p><strong>Cypher uses BFS for:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">shortestPath</span><span class="p">((</span><span class="n">alice</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="p">*</span><span class="o">]-</span><span class="p">(</span><span class="n">bob</span><span class="p">))</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Time complexity:</strong> O(V + E) where V = vertices, E = edges</p>
<h3 id="dijkstras-algorithm">Dijkstra's Algorithm</h3>
<p><strong>How it works:</strong>
1. Assign tentative distances to all nodes (infinity, except source = 0)
2. Visit unvisited node with smallest distance
3. Update distances to neighbors
4. Repeat until target reached</p>
<p><strong>When you'd use it:</strong> Weighted graphs where relationships have costs.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// If FRIEND_OF had a &#39;distance&#39; property</span>
<span class="k">MATCH</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">shortestPath</span><span class="p">((</span><span class="n">alice</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="p">*</span><span class="o">]-</span><span class="p">(</span><span class="n">bob</span><span class="p">))</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">reduce</span><span class="p">(</span><span class="n">dist</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">relationships</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">distance</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">totalDistance</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Time complexity:</strong> O((V + E) log V) with priority queue</p>
<h3 id="a-algorithm">A* Algorithm</h3>
<p><strong>How it works:</strong> Like Dijkstra, but uses a heuristic (estimated cost to goal) to explore promising paths first.</p>
<p><strong>When you'd use it:</strong> Spatial graphs (geographic networks, routing) where you have coordinate data to estimate distances.</p>
<p><strong>Example use case:</strong> Finding shortest driving route on road network graph.</p>
<p><strong>Time complexity:</strong> Depends on heuristic quality, often much faster than Dijkstra in practice</p>
<h3 id="why-you-care">Why You Care</h3>
<p>When the AI generates:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">shortestPath</span><span class="p">((</span><span class="n">a</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="p">*</span><span class="o">]-</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</code></pre></div></td></tr></table></div></p>
<p>You now know it's running BFS. If the query is slow, you know:
- BFS is O(V + E), so it might be traversing millions of relationships
- You could limit max hops: <code>shortestPath((a)-[:FRIEND_OF*..6]-(b))</code>
- Or you could check if an index on Person.name exists to find <code>a</code> and <code>b</code> quickly</p>
<p>See? Understanding algorithms helps you debug AI-generated code!</p>
<h2 id="query-plans-reading-the-execution-blueprint">Query Plans: Reading the Execution Blueprint</h2>
<p><strong>Query plans</strong> show exactly how the database will execute your query.</p>
<p><strong>Get the plan without running:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">EXPLAIN</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">alice</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">30</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">name</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">friend</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Typical plan operations:</strong></p>
<table>
<thead>
<tr>
<th>Operation</th>
<th>What It Does</th>
<th>Performance</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>NodeByLabelScan</code></td>
<td>Scan all nodes with a label</td>
<td>Slow (O(n))</td>
</tr>
<tr>
<td><code>NodeIndexSeek</code></td>
<td>Use index to find nodes</td>
<td>Fast (O(log n))</td>
</tr>
<tr>
<td><code>Expand(All)</code></td>
<td>Follow all relationships</td>
<td>O(degree) per node</td>
</tr>
<tr>
<td><code>Filter</code></td>
<td>Apply WHERE conditions</td>
<td>Depends on selectivity</td>
</tr>
<tr>
<td><code>Sort</code></td>
<td>Order results</td>
<td>O(n log n)</td>
</tr>
<tr>
<td><code>Limit</code></td>
<td>Take first N results</td>
<td>Fast</td>
</tr>
<tr>
<td><code>Distinct</code></td>
<td>Remove duplicates</td>
<td>O(n)</td>
</tr>
</tbody>
</table>
<p><strong>Reading a plan:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code>Plan:
+------------------+--------+--------+
| Operator         | Rows   | DB Hits|
+------------------+--------+--------+
| ProduceResults   |   12   |    0   |
| Sort             |   12   |   24   |
| Filter           |   12   |   45   |
| Expand(All)      |   45   |   90   |
| NodeIndexSeek    |    1   |    2   |
+------------------+--------+--------+
</code></pre></div></td></tr></table></div></p>
<p><strong>Interpretation:</strong>
1. <strong>NodeIndexSeek</strong> (bottom): Found 1 Alice node using index (2 db hits)
2. <strong>Expand(All)</strong>: Followed FRIEND_OF edges, found 45 friends (90 db hits)
3. <strong>Filter</strong>: Checked age &gt; 30, kept 12 results (45 db hits)
4. <strong>Sort</strong>: Sorted 12 results by name (24 db hits)
5. <strong>ProduceResults</strong> (top): Returned 12 rows</p>
<p><strong>Red flags to look for:</strong>
- âŒ <code>NodeByLabelScan</code> when you expected <code>NodeIndexSeek</code> (missing index!)
- âŒ Huge row counts early in plan that filter down later (filter earlier!)
- âŒ <code>CartesianProduct</code> (accidental cross join)
- âŒ High DB hits relative to rows returned (inefficient access pattern)</p>
<p><strong>When the AI's query is slow:</strong> Look at the plan. You might see it's doing a label scan instead of an index seek, meaning you need to create an index. Or it's expanding too broadly before filtering. Understanding plans = debugging superpowers.</p>
<h2 id="bringing-it-all-together-a-realistic-example">Bringing It All Together: A Realistic Example</h2>
<p>Let's build a complete query using everything we've learned. Imagine you're building a social network feature: "People you may know."</p>
<p><strong>Requirements:</strong>
- Find people who are friends with your friends (2-hop)
- But exclude people you're already friends with
- Prioritize people in the same city
- Show people with mutual friends count
- Limit to top 10 suggestions</p>
<p><strong>The query:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">suggestion</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-</span><span class="p">(</span><span class="n">suggestion</span><span class="p">)</span><span class="w">  </span><span class="c1">// Not already friends</span>
<span class="w">  </span><span class="n">AND</span><span class="w"> </span><span class="n">suggestion</span><span class="w"> </span><span class="p">&lt;&gt;</span><span class="w"> </span><span class="n">me</span><span class="w">                     </span><span class="c1">// Not myself</span>
<span class="k">WITH</span><span class="w"> </span><span class="n">suggestion</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">friend</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">mutualFriends</span><span class="p">,</span><span class="w"> </span><span class="n">suggestion</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">myCity</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span>
<span class="w">  </span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">myCity</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">ELSE</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="k">END</span><span class="w"> </span><span class="k">DESC</span><span class="p">,</span><span class="w">  </span><span class="c1">// Same city first</span>
<span class="w">  </span><span class="n">mutualFriends</span><span class="w"> </span><span class="k">DESC</span><span class="w">                                </span><span class="c1">// Then by mutual friends</span>
<span class="k">RETURN</span>
<span class="w">  </span><span class="n">suggestion</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>
<span class="w">  </span><span class="n">suggestion</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">city</span><span class="p">,</span>
<span class="w">  </span><span class="n">mutualFriends</span><span class="p">,</span>
<span class="w">  </span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">myCity</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s">&#39;Same city!&#39;</span><span class="w"> </span><span class="n">ELSE</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="w"> </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">note</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="m">10</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Breaking it down:</strong>
1. <strong>MATCH:</strong> Find 2-hop friends
2. <strong>WHERE:</strong> Filter out existing friends and self
3. <strong>WITH:</strong> Aggregate mutual friends count, prepare for sorting
4. <strong>ORDER BY:</strong> Same city first, then by mutual friend count
5. <strong>RETURN:</strong> Format output nicely
6. <strong>LIMIT:</strong> Top 10 suggestions</p>
<p><strong>What an AI might get wrong:</strong>
- Forgetting <code>suggestion &lt;&gt; me</code> (suggesting yourself)
- Not using <code>DISTINCT</code> in count (counting same mutual friend multiple times if multiple paths exist)
- Inefficient pattern (could use variable-length path with max 2 hops for clarity)</p>
<p><strong>Optimized version:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Create index first for better performance</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">person_name</span><span class="w"> </span><span class="n">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">EXISTS</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">:</span><span class="n">Person</span><span class="p">)</span><span class="w"> </span><span class="n">ON</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>

<span class="c1">// Optimized query</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">:</span><span class="n">Person</span><span class="w"> </span><span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">})</span>
<span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">suggestion</span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FRIEND_OF</span><span class="o">]-</span><span class="p">(</span><span class="n">suggestion</span><span class="p">)</span>
<span class="w">  </span><span class="n">AND</span><span class="w"> </span><span class="n">suggestion</span><span class="w"> </span><span class="p">&lt;&gt;</span><span class="w"> </span><span class="n">me</span>
<span class="k">WITH</span><span class="w"> </span><span class="n">suggestion</span><span class="p">,</span>
<span class="w">     </span><span class="n">count</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">friend</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">mutualFriends</span><span class="p">,</span>
<span class="w">     </span><span class="n">me</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">suggestion</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sameCity</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">sameCity</span><span class="w"> </span><span class="k">DESC</span><span class="p">,</span><span class="w"> </span><span class="n">mutualFriends</span><span class="w"> </span><span class="k">DESC</span>
<span class="k">RETURN</span><span class="w"> </span><span class="n">suggestion</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">suggestion</span><span class="p">.</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">mutualFriends</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="m">10</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Performance considerations:</strong>
- Index on <code>Person.name</code> makes finding Alice fast
- Filtering <code>NOT (me)-[:FRIEND_OF]-(suggestion)</code> happens during traversal (efficient)
- <code>LIMIT 10</code> stops earlyâ€”doesn't need to find all suggestions
- <code>DISTINCT</code> in count prevents duplicate counting</p>
<p>Now you can read this query, understand it, optimize it, and explain itâ€”even if an AI wrote it.</p>
<h2 id="the-bottom-line-why-learning-this-matters">The Bottom Line: Why Learning This Matters</h2>
<p>We opened this chapter with a wink: "AI will probably write your queries." And that's likely true. But here's what we've learned:</p>
<ol>
<li><strong>Reading code is a superpower:</strong> When the AI generates a query, you can understand what it does</li>
<li><strong>Debugging is essential:</strong> When queries fail or are slow, you can spot the issue</li>
<li><strong>Optimization requires knowledge:</strong> You can't tune what you don't understand</li>
<li><strong>Communication improves:</strong> "Use MERGE, not CREATE" is faster than explaining duplicates</li>
<li><strong>Trust but verify:</strong> You can review AI-generated code for correctness and efficiency</li>
</ol>
<p>Think of this chapter as <strong>query language literacy</strong>. You might not write Cypher from scratch every day, but you'll read it, review it, debug it, and optimize it. And when the AI suggests something that looks wrong, you'll have the knowledge to catch it.</p>
<p><strong>Final thought:</strong> AI is doubling every seven months, yes. But so is the amount of data we're storing and querying. The problems are growing as fast as the solutions. Understanding graph query languages isn't about whether AI can write themâ€”it's about understanding what needs to be written, why it works (or doesn't), and how to make it better.</p>
<p>Plus, honestly? There's something deeply satisfying about reading a complex Cypher query and thinking, "Yeah, I know exactly what that does." That's worth learning, AI or no AI. ðŸ˜Š</p>
<h2 id="key-takeaways">Key Takeaways</h2>
<ol>
<li><strong>OpenCypher is the people's champion:</strong> Most popular, visual syntax, widely adopted</li>
<li><strong>GSQL is for scale:</strong> Map-reduce patterns and accumulators for billion-node graphs</li>
<li><strong>GQL is the future:</strong> ISO standard emerging, SQL-like, future-proof</li>
<li><strong>MATCH finds patterns:</strong> Declarative pattern matching is Cypher's superpower</li>
<li><strong>WHERE filters, RETURN shapes:</strong> Basic clauses you'll see everywhere</li>
<li><strong>CREATE adds, MERGE upserts:</strong> CREATE makes duplicates, MERGE doesn't</li>
<li><strong>Variable-length paths are powerful but dangerous:</strong> Always set max length</li>
<li><strong>Shortest path uses BFS:</strong> Understanding algorithms helps debug performance</li>
<li><strong>Query plans reveal execution:</strong> EXPLAIN and PROFILE are your debugging friends</li>
<li><strong>Declarative vs imperative:</strong> Different tools for different scales</li>
<li><strong>Accumulators enable distributed aggregation:</strong> GSQL's secret sauce for massive graphs</li>
<li><strong>Optimization matters:</strong> Indexes, early filtering, avoiding Cartesian products</li>
<li><strong>AI will write queries, but you need to read them:</strong> Literacy &gt; authorship</li>
</ol>
<p>Now go forth and read graph queries with confidence! And when the AI inevitably tries to use <code>CREATE</code> where it should use <code>MERGE</code>, you'll catch it. ðŸ˜‰</p>
<hr />
<p><em>Remember: The best code is code you understandâ€”whether you wrote it or an AI did. This chapter gave you the tools to understand graph query languages. Use them wisely (and when the AI messes up, you know we told you so!)</em></p>







  
  



  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../03-labeled-property-graph-model/quiz/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Quiz">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Quiz
              </div>
            </div>
          </a>
        
        
          
          <a href="quiz/" class="md-footer__link md-footer__link--next" aria-label="Next: Quiz">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Quiz
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Dan McCreary. Licensed under <a href="license/">CC BY-NC-SA 4.0</a> for non-commercial use.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.expand", "navigation.path", "navigation.prune", "navigation.indexes", "toc.follow", "navigation.top", "navigation.footer", "content.action.edit"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../js/extra.js"></script>
      
    
  </body>
</html>